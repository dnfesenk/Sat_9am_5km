<% head_info :title, @event.name %>

<% unless @event.active %>
  <div class="alert alert-danger d-flex align-items-center" role="alert">
    <i class="bi bi-exclamation-triangle-fill"></i>&nbsp;
    <div>
      <strong>Внимание!</strong> <%= @total_activities.zero? ? 'Скоро открытие!' : 'Ближайший старт отменён.' %>
      Следите за новостями в <a href="https://t.me/s95news" class="alert-link">телеграм-канале</a>,
      а пока приходите на другие <a href='/' class="alert-link">наши пробежки</a>.
    </div>
  </div>
<% end %>

<div class="row mb-3 px-3">
  <div class="col-12 col-xxl-10 mx-auto position-relative px-0">
    <div class="position-absolute top-0 bg-dark bg-gradient bg-opacity-25 w-100 px-3 rounded-top">
      <h4 class="text-light"><%= @event.name %></h4>
    </div>
    <%= event_main_image_tag @event, class: 'img-fluid rounded', alt: 'Место мероприятия', title: @event.name %>
  </div>
</div>

<%= sanitized_text @event.description %>

<h4>Наши контакты</h4>
<div class="d-flex flex-wrap">
  <% @event.contacts.order(:contact_type).each do |contact| %>
    <%= link_to(contact.link.html_safe, target: '_blank', rel: 'noopener', class: 'me-2 me-sm-3 mb-2') do %>
      <% image_tag "social/#{contact.contact_type}.png", class: 'img-social', title: I18n.t("activerecord.attributes.contact.contact_types.#{contact.contact_type}") %>
    <% end %>
  <% end %>
</div>

<h2>Результаты</h2>
<div class="row">
  <div class="col-12">
    <% if @total_activities.zero? %>
      <p>Пока ещё тут нет загруженных и опубликованных результатов.</p>
    <% else %>
      <table class="table table-striped table-centered">
        <thead>
          <tr>
            <th>#</th>
            <th>Дата</th>
            <th>Участники</th>
            <th>Волонтёры</th>
            <th class="hidden-on-phone">Первый</th>
            <th class="hidden-on-phone">Первая</th>
          </tr>
        </thead>
        <tbody class="table-group-divider">
          <%= render partial: 'activity', collection: @event.activities.published.order(date: :desc), cached: true %>
        </tbody>
      </table>
    <% end %>
  </div>
</div>

<div class="row">
  <div class="col-12 col-md-4">
    <h3>Как принять участие?</h3>
    <p>
      Бесплатные старты на 5 км для всех каждую субботу с фиксацией времени. Дистанцию можно пробежать, пройти пешком,
      либо <a href="<%= volunteering_event_path(@event.code_name) %>">попробовать себя в качестве организатора-волонтёра</a>.
      У нас рады всем вне зависимости от возраста и уровня подготовки.
    </p>
  </div>
  <div class="col-12 col-md-4">
    <h3>Как нас найти?</h3>
    <p>
      <%= @event.place %>
    </p>
  </div>
  <div class="col-12 col-md-4">
    <h3>Сколько стоит?</h3>
    <p>
      Наши забеги всегда были и будут бесплатными для всех. Мы проводим их силами волонтёров.
    </p>
  </div>
</div>
